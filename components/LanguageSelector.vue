<template>
  <UDropdown :items="[languages]" :popper="{ placement: 'bottom-end' }">
    <UButton 
      variant="ghost" 
      color="gray"
      size="sm"
      trailing-icon="i-heroicons-chevron-down-20-solid"
    >
      <template #leading>
        <span class="text-base">{{ currentFlag }}</span>
      </template>
      {{ currentName }}
    </UButton>
  </UDropdown>
</template>

<script setup lang="ts">
const { locale, setLocale } = useI18n()

const languages = [
  { 
    label: 'í•œêµ­ì–´', 
    icon: 'ðŸ‡°ðŸ‡·',
    click: () => switchLang('ko'),
    code: 'ko'
  },
  { 
    label: 'English', 
    icon: 'ðŸ‡ºðŸ‡¸',
    click: () => switchLang('en'),
    code: 'en'
  },
  { 
    label: 'æ—¥æœ¬èªž', 
    icon: 'ðŸ‡¯ðŸ‡µ',
    click: () => switchLang('ja'),
    code: 'ja'
  },
  { 
    label: 'ä¸­æ–‡', 
    icon: 'ðŸ‡¨ðŸ‡³',
    click: () => switchLang('zh'),
    code: 'zh'
  }
]

const currentFlag = computed(() => {
  const current = languages.find(l => l.code === locale.value)
  return current?.icon || 'ðŸ‡°ðŸ‡·'
})

const currentName = computed(() => {
  const current = languages.find(l => l.code === locale.value)
  return current?.label || 'í•œêµ­ì–´'
})

const switchLang = (code: 'ko' | 'en' | 'ja' | 'zh') => {
  setLocale(code)
}
</script>
